/*==========================================================================*\
  A single event on the homepage
\*==========================================================================*/
"use strict";

var BaseView = require('app/base/base-view');

module.exports = BaseView.extend({
  template: require('app/templates').event['event-item'],

  noImageUrl: 'img/no-image.png',

  render: function () {
    this.renderWithTemplate(this);

    this.cacheElements({
      bgEl: '.bg',
      eventTitleEl: '.event-title'
    });

    this.el.classList.toggle('locked', this.model.password && this.model.locked);
    this.el.classList.toggle('showcased', this.model.showcased);

    // Set image url
    var imageUrl = this.model.thumb_url || this.noImageUrl;
    if (!this.model.display_image) {
      imageUrl = this.model.thumb_blur_url || imageUrl;
    }
    this.bgEl.style.backgroundImage = 'url('+ imageUrl +')';

    // Set image position
    if (this.model.img_position) {
      this.bgEl.style.backgroundPosition = this.model.img_position;
    }

    // Set event title class
    var len = this.model.name.length;
    var titleClass = len >= 25 ? 'long-' + Math.min(10, Math.floor((len - 25) / 10)) : '';
    if (titleClass) {
      this.eventTitleEl.classList.add(titleClass);
    }

    return this;
  }

});
