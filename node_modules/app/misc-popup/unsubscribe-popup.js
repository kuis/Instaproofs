/*==========================================================================*\
  A popup with a contact form
\*==========================================================================*/
"use strict";
var MiscPopup = require('./misc-popup');
var UnsubscribeMixin = require('./unsubscribe-mixin');

var app = require('app');
var xhr = require('xhr');

module.exports = MiscPopup.extend(UnsubscribeMixin, {
  template: require('app/templates')['misc-popup'].unsubscribe,

  bindings: {
    'model.name': {
      type: 'text',
      selector: '.event-name'
    }
  },

  events: {

  },

  initialize: function (ops) {
    MiscPopup.prototype.initialize.apply(this, arguments);

    this.eid = ops.eid;
    this.email = ops.email;
    this.prefId = ops.prefId;

    if (!this.model.name || !this.model.complete) {
      this.model.fetchByOrigin();
    }

    this.listenTo(this.model, 'change:name', function () {
      this.getEmailSubscriptions();
    });

  }
});
