/*==========================================================================*\
 Unsubscribe Functionalities Mixin
 \*==========================================================================*/
'use strict';

var app = require('app');
var axios = require('axios');
var assign = require('lodash.assign');

module.exports = {

  /**
   * Update email notification subscription settings.
   *
   * @param {string}  eventId - event id
   * @param {string}  prefId - preference id
   * @param {string}  email - email
   * @param {object}  params - subscription settings
   * @returns {object}  promise to xhr call
   */
  updateEmailSubscriptions: function (eventId, prefId, email, params) {
    var apiUrl = app.apiUrl + 'events/' + eventId + '/subscribe/' + prefId;

    params = assign({}, params, {
      url: app.url,
      email: email
    });

    return axios.put(apiUrl, params);
  },

  /**
   * Get a list of the email subscription preferences for a user
   *
   * @param {string}  eventId - event id
   * @param {string}  prefId - preference id
   * @param {string}  email - email
   * @returns {object}  promise to xhr call
   */
  getEmailSubscriptions: function (eventId, prefId, email) {
    var apiUrl = app.apiUrl + 'events/' + eventId + '/subscribe/' + prefId;
    var params = {
      url: app.url,
      email: email
    };

    return axios.get(apiUrl, {
      params: params
    });
  }
};
