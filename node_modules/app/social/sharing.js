/*==========================================================================*\
  Social sharing functionality
\*==========================================================================*/
"use strict";
var app = require('app');

module.exports = {
  popup: function (e, platform, pid, eid) {
    // var social = app.config.social['sharing_'+ platform];
    var href = this.getUrl(platform, pid, eid);
    // if (social) {
    //   href = decodeURI(social.url).replace('[[product_id]]', pid);
    // }
    // else {
    //   switch (platform) {
    //     case 'instagram':
    //       break;
    //   }
    // }
    // "http://www.instaproofs.com/socialBookmark.php?sb=1&url=%2Fshare.php%3Fid%3Devent_id%26v3%3D1%26pid%3Dproduct_id&pid=[[product_id]]"
    var winWidth = 520;
    var winHeight = 350;
    switch (platform) {
      case 'googleplus':
        winWidth = 1020;
        winHeight = 520;
        break;
      case 'twitter':
        winWidth = 600;
        winHeight = 450;
        break;
    }
    var winTop = (screen.height / 2) - (winHeight / 2);
    var winLeft = (screen.width / 2) - (winWidth / 2);
    switch (platform) {
      case 'facebook':
        // href = 'http://www.facebook.com/sharer.php?s=100&p[title]=' + title + 
        //     '&p[summary]=' + summary + '&p[url]=' + url + '&p[images][0]=' + image
        break;
    }
    // "http://www.instaproofs.com/socialBookmark.php?sb=1&url=%2Fshare.php%3Fid%3D%5B%5Bevent_id%5D%5D%26v3%3D1%26pid%3D%5B%5Bproduct_id%5D%5D&pid=[[product_id]]&eid=[[event_id]]&uid=[[user_id]]"
    window.open(href, 'sharer', 'top='+ winTop +',left='+ winLeft +
        ',toolbar=0,status=0,width='+ winWidth +',height='+ winHeight);
    
    if (e && e.preventDefault) e.preventDefault();
    return false;
  },
  // http://jonathan.instaproofs.com/socialBookmark.php?sb=1&url=http%3A%2F%2Fjonathan.instaproofs.com%2Fshare.php%3Fid%3D1330620%26v3%3D1%26pid%3D350643348&pid=350643348&title=Sister+Andrea+%26+Obrien+-+Sister+Andre+%26+Sister+Obrien+Color+001
  getUrl: function (platform, pid, eid) {
    var social = app.config.social['sharing_'+ platform];
    if (social) {
      // return social.url.replace(/www\.instaproofs/gi, 'demo.instaproofs')
      //                  .replace('[[product_id]]', pid);
      // console.log(platform, pid, eid);
      return social.url.replace(/www\.instaproofs/gi, 'demo.instaproofs')
                       .replace(/\[\[product_id\]\]/, pid)
                       .replace(/\[\[event_id\]\]/, eid)
                       .replace(/\[\[user_id\]\]/, '0');
    }
    else {
      switch (platform) {
        case 'instagram':
          break;
      }
    }
  },
};
