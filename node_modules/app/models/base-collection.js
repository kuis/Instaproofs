/*==========================================================================*\
  Base collection to be extended by all others
\*==========================================================================*/
"use strict";

var app = require('app');
var Collection = require('ampersand-rest-collection');

module.exports = require('ampersand-rest-collection').extend({
  parse: function (res) {
    if (res.config) {
      app.state.bootstrapped = true;
      app.config.set(res.config);
    }
    if (res.photographer) app.photographer.set(res.photographer);
    if (res.purchase_addons) app.purchaseAddons.set(res.purchase_addons);
    if (res.purchase_options) app.purchaseOptions.set(res.purchase_options, { 
      parse: true 
    });
    return res.data;
  },
  
  fetch: function (options) {
    options = options || {};
    options.data = options.data || {};
    if (!app.state.bootstrapped) {
      options.data.bootstrap = 1;
    }
    return Collection.prototype.fetch.call(this, options);
  },
});
